#include "stubs.h"
#include <stdint.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#include "suit_bootloader.h"
#include "suit_parser.h"

uint8_t simple_bad_input[] = 
{
0xA2,0x02,0x58,0x77,0x81,0xD2,0x84,0x43,0xA1,0x01,0x26,0xA0,
0x5B, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xED,
0x82,0x02,
0x58,0x20,0x1D,0x15,0xA1,0x71,0x3D,0x3A,0x45,0x10,0xCA,0x39,0x24,0x54,0xAD,0xFF,
0x98,0x7A,0xBB,0x54,0x25,0x34,0x8E,0x44,0x96,0x18,0x12,0x2F,0xFA,0x81,0x70,0x12,
0xCC,0x31,0x5B, 0x40, 0x19,0x7A,0x4A,0x3A,0x41,0x88,0xFE,0x1D,0xD8,0xBA,0xA4,0x68,
0xAE,0x9A,0x35,0xAC,0x8E,0x5E,0xF4,0x62,0x01,0x75,0x30,0x11,0x6E,0xAD,0xD9,0x08,
0x92,0xC9,0x6C,0x6A,0xB0,0x08,0x25,0xFC,0xB4,0x5E,0xDB,0x75,0x75,0x47,0x73,0x3C,
0x14,0xD3,0xB6,0x37,0xEA,0x8A,0x08,0x5C,0xE7,0xBF,0xC7,0x82,0xA0,0xB2,0xCD,0x80,
0xD3,0x1B,0x12,0x94,

0x03,0x58,0xFC,0xA5,0x01,0x01,0x02,0x03,0x03,0x58,0x99,0xA2,
0x02,0x44,0x81,0x81,0x41,0x00,0x04,0x58,0x8F,0x88,0x14,0xA2,0x01,0x50,0xFA,0x6B,
0x4A,0x53,0xD5,0xAD,0x5F,0xDF,0xBE,0x9D,0xE6,0x63,0xE4,0xD4,0x1F,0xFE,0x02,0x50,
0x14,0x92,0xAF,0x14,0x25,0x69,0x5E,0x48,0xBF,0x42,0x9B,0x2D,0x51,0xF2,0xAB,0x45,
0x0F,0x82,0x58,0x2E,0x84,0x05,0xF6,0x14,0xA2,0x03,0x82,0x02,0x58,0x20,0x00,0x11,
0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xAA,0xBB,0xCC,0xDD,0xEE,0xFF,0x01,0x23,
0x45,0x67,0x89,0xAB,0xCD,0xEF,0xFE,0xDC,0xBA,0x98,0x76,0x54,0x32,0x10,0x0E,0x19,
0x87,0xD0,0x58,0x30,0x84,0x05,0xF6,0x14,0xA2,0x03,0x82,0x02,0x58,0x20,0x01,0x23,
0x45,0x67,0x89,0xAB,0xCD,0xEF,0xFE,0xDC,0xBA,0x98,0x76,0x54,0x32,0x10,0x00,0x11,
0x22,0x33,0x44,0x55,0x66,0x77,0x88,0x99,0xAA,0xBB,0xCC,0xDD,0xEE,0xFF,0x0E,0x1A,
0x00,0x01,0x2C,0x22,0x01,0xF6,0x02,0xF6,0x09,0x58,0x53,0x86,0x0F,0x82,0x58,0x24,
0x84,0x05,0xF6,0x13,0xA1,0x15,0x78,0x1C,0x68,0x74,0x74,0x70,0x3A,0x2F,0x2F,0x65,
0x78,0x61,0x6D,0x70,0x6C,0x65,0x2E,0x63,0x6F,0x6D,0x2F,0x66,0x69,0x6C,0x65,0x31,
0x2E,0x62,0x69,0x6E,0x58,0x24,0x84,0x05,0xF6,0x13,0xA1,0x15,0x78,0x1C,0x68,0x74,
0x74,0x70,0x3A,0x2F,0x2F,0x65,0x78,0x61,0x6D,0x70,0x6C,0x65,0x2E,0x63,0x6F,0x6D,
0x2F,0x66,0x69,0x6C,0x65,0x32,0x2E,0x62,0x69,0x6E,0x15,0xF6,0x03,0xF6,0x0A,0x43,
0x82,0x03,0xF6
};

/* An example of hanging/crashing the parser by providing large input length.
 */
int main(int argc, char *argv[]) 
{
    int result_code = 0;
    result_code = suit_do_process_manifest(simple_bad_input, sizeof(simple_bad_input));
    printf("Result code: %d\r\n", result_code);
    return 0;
}
